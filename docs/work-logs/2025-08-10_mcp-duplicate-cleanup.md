# MCP重複接続の解消作業

## 作業日時
2025-08-10

## 作業の背景と目的

Claude CodeのMCPサーバー接続において、「lsmcp」と「typescript」の2つの接続が存在し、片方が失敗している状態だった。これは同じTypeScript Language Serverへの重複した接続設定が原因であり、エラーメッセージが表示される問題を解消する必要があった。

## 実施した変更内容

### 1. 重複プロセスの特定と終了
- 複数のlsmcpプロセスが並行して実行されていることを確認
  - 8月9日から実行中の古いプロセス（PID: 615253, 615260）
  - 10:17から実行中のプロセス（PID: 643173, 643180）
  - 10:28から実行中の最新プロセス
- 古いプロセスを全て終了し、クリーンな状態に

### 2. MCP設定ファイルの修正
- `.mcp.json`から重複していた「lsmcp」設定を削除
- 空のmcpServers設定に変更することで、プロジェクトレベルでの重複を解消

### 3. 動作確認
- TypeScript MCPサーバーの正常動作を確認
- プロジェクト概要の取得、型エラーチェック、ドキュメントシンボル取得など、全機能が利用可能であることを検証

## 変更されたファイル

1. **`.mcp.json`**
   - `mcpServers.lsmcp`設定を削除
   - 空のオブジェクトに変更

2. **`.lsmcp/`ディレクトリ** (新規作成)
   - TypeScript Language Serverのキャッシュディレクトリ
   - gitignoreへの追加が推奨される

## 成果・結果

- MCP接続の重複エラーが解消
- `/mcp`コマンド実行時のエラーメッセージが表示されなくなった
- TypeScript Language Serverが正常に動作し、コード分析機能が利用可能に

## 今後の課題

- `.lsmcp/`ディレクトリを`.gitignore`に追加することを検討
- MCP設定の管理方法についてのドキュメント化